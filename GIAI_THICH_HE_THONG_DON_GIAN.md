# ğŸ“š GIáº¢I THÃCH Há»† THá»NG SMART FARM - CÃCH ÄÆ N GIáº¢N

> **TÃ i liá»‡u nÃ y giáº£i thÃ­ch há»‡ thá»‘ng theo cÃ¡ch dá»… hiá»ƒu nháº¥t, khÃ´ng cáº§n kiáº¿n thá»©c láº­p trÃ¬nh**

---

## ğŸ¯ Há»† THá»NG LÃ€ GÃŒ?

**Smart Farm** lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ nÃ´ng tráº¡i thÃ´ng minh, giÃºp nÃ´ng dÃ¢n:
- ğŸ“Š Xem dá»¯ liá»‡u tá»« cáº£m biáº¿n (nhiá»‡t Ä‘á»™, Ä‘á»™ áº©m, Ä‘áº¥t)
- ğŸ¤– Há»i AI vá» ká»¹ thuáº­t trá»“ng trá»t
- ğŸŒ± Nháº­n gá»£i Ã½ cÃ¢y trá»“ng phÃ¹ há»£p
- ğŸ› PhÃ¡t hiá»‡n sÃ¢u bá»‡nh qua áº£nh
- ğŸ’° Quáº£n lÃ½ thu hoáº¡ch vÃ  doanh thu

---

## ğŸ—ï¸ KIáº¾N TRÃšC Tá»”NG QUAN (HÃ¬nh áº£nh Ä‘Æ¡n giáº£n)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           NGÆ¯á»œI DÃ™NG (NÃ´ng dÃ¢n)                 â”‚
â”‚         (DÃ¹ng trÃ¬nh duyá»‡t web)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   GIAO DIá»†N WEB      â”‚  â† NgÆ°á»i dÃ¹ng tháº¥y gÃ¬?
        â”‚   (Frontend React)    â”‚     - Trang Ä‘Äƒng nháº­p
        â”‚   Port: 80           â”‚     - Dashboard
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     - Form nháº­p liá»‡u
                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                      â”‚
        â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   BACKEND    â”‚      â”‚   CHATBOT    â”‚
â”‚   (Java)     â”‚      â”‚  (Next.js)   â”‚
â”‚   Port: 8080 â”‚      â”‚  Port: 9002  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                     â”‚
       â”‚                     â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚          â”‚
       â–¼          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CROP ML     â”‚  â”‚  PEST ML     â”‚
â”‚  (Python)    â”‚  â”‚  (Python)    â”‚
â”‚  Port: 5000  â”‚  â”‚  Port: 5001  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DATABASE    â”‚
â”‚ (PostgreSQL) â”‚
â”‚  Port: 5432  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ CÃC THÃ€NH PHáº¦N CHÃNH (9 pháº§n)

### 1. ğŸŒ **Frontend (Giao diá»‡n web)** - `J2EE_Frontend/`
**Nhiá»‡m vá»¥:** Hiá»ƒn thá»‹ giao diá»‡n cho ngÆ°á»i dÃ¹ng

**VÃ­ dá»¥ Ä‘Æ¡n giáº£n:**
- Giá»‘ng nhÆ° **mÃ n hÃ¬nh TV**, ngÆ°á»i dÃ¹ng nhÃ¬n tháº¥y vÃ  tÆ°Æ¡ng tÃ¡c
- Khi báº¡n click nÃºt "Gá»£i Ã½ cÃ¢y trá»“ng", nÃ³ gá»­i yÃªu cáº§u Ä‘áº¿n Backend

**File quan trá»ng:**
- `App.js` - File chÃ­nh, quáº£n lÃ½ táº¥t cáº£ cÃ¡c trang
- `pages/crop/CropRecommendation.js` - Trang gá»£i Ã½ cÃ¢y trá»“ng
- `services/cropRecommendationService.js` - Gá»­i request Ä‘áº¿n Backend

**Luá»“ng hoáº¡t Ä‘á»™ng:**
```
User nháº­p dá»¯ liá»‡u â†’ Click "Gá»£i Ã½" 
â†’ Frontend gá»­i request Ä‘áº¿n Backend (http://localhost:8080/api/crop/recommend)
â†’ Nháº­n káº¿t quáº£ â†’ Hiá»ƒn thá»‹ lÃªn mÃ n hÃ¬nh
```

---

### 2. â˜• **Backend (Server xá»­ lÃ½)** - `demoSmartFarm/demo/`
**Nhiá»‡m vá»¥:** Xá»­ lÃ½ logic, káº¿t ná»‘i Database, gá»i ML services

**VÃ­ dá»¥ Ä‘Æ¡n giáº£n:**
- Giá»‘ng nhÆ° **bá»™ nÃ£o** cá»§a há»‡ thá»‘ng
- Nháº­n yÃªu cáº§u tá»« Frontend â†’ Xá»­ lÃ½ â†’ Tráº£ káº¿t quáº£

**Cáº¥u trÃºc:**
```
Controllers/     â†’ Nháº­n request tá»« Frontend
Services/        â†’ Xá»­ lÃ½ logic nghiá»‡p vá»¥
Repositories/    â†’ Truy váº¥n Database
Entities/        â†’ Äá»‹nh nghÄ©a cáº¥u trÃºc dá»¯ liá»‡u
```

**VÃ­ dá»¥ luá»“ng Login:**
```
1. User nháº­p email/password â†’ Frontend gá»­i Ä‘áº¿n /api/auth/login
2. AuthController nháº­n request
3. AccountService kiá»ƒm tra email/password trong Database
4. Náº¿u Ä‘Ãºng â†’ Táº¡o JWT token â†’ Tráº£ vá» Frontend
5. Frontend lÆ°u token â†’ User Ä‘Äƒng nháº­p thÃ nh cÃ´ng
```

**VÃ­ dá»¥ luá»“ng Crop Recommendation:**
```
1. Frontend gá»­i: {temperature: 25, humidity: 80, soil_moisture: 45}
2. CropRecommendationController nháº­n request
3. AIRecommendationService gá»i Python ML service (http://crop-service:5000)
4. Python tráº£ vá»: {recommended_crop: "DÆ°a háº¥u", confidence: 0.85}
5. Backend chuyá»ƒn Ä‘á»•i â†’ Tráº£ vá» Frontend
6. Frontend hiá»ƒn thá»‹: "CÃ¢y trá»“ng Ä‘Æ°á»£c gá»£i Ã½: DÆ°a háº¥u"
```

---

### 3. ğŸ¤– **AI Chatbot** - `AI_SmartFarm_CHatbot/`
**Nhiá»‡m vá»¥:** Tráº£ lá»i cÃ¢u há»i vá» nÃ´ng nghiá»‡p báº±ng AI

**VÃ­ dá»¥ Ä‘Æ¡n giáº£n:**
- Giá»‘ng nhÆ° **trá»£ lÃ½ áº£o** cÃ³ thá»ƒ tráº£ lá»i cÃ¢u há»i
- Sá»­ dá»¥ng Google Gemini AI Ä‘á»ƒ hiá»ƒu vÃ  tráº£ lá»i

**Luá»“ng hoáº¡t Ä‘á»™ng:**
```
1. User gÃµ: "CÃ¡ch trá»“ng lÃºa?"
2. Frontend gá»­i Ä‘áº¿n Chatbot (http://localhost:9002)
3. Chatbot Ä‘á»c file Excel chá»©a cÃ¢u há»i-Ä‘Ã¡p
4. Gá»­i cÃ¢u há»i + dá»¯ liá»‡u Excel cho Google Gemini AI
5. AI phÃ¢n tÃ­ch vÃ  tráº£ lá»i: "Trá»“ng lÃºa cáº§n Ä‘áº¥t phÃ¹ sa, nÆ°á»›c Ä‘áº§y Ä‘á»§..."
6. Chatbot tráº£ vá» Frontend â†’ Hiá»ƒn thá»‹ cho user
```

**File quan trá»ng:**
- `src/ai/flows/generate-insights-from-excel.ts` - Logic xá»­ lÃ½ AI
- `src/app/page.tsx` - Giao diá»‡n chatbot
- `src/data/sample-data.xlsx` - File dá»¯ liá»‡u cÃ¢u há»i-Ä‘Ã¡p

---

### 4. ğŸŒ± **Crop Recommendation ML** - `RecommentCrop/`
**Nhiá»‡m vá»¥:** Gá»£i Ã½ cÃ¢y trá»“ng dá»±a trÃªn Ä‘iá»u kiá»‡n mÃ´i trÆ°á»ng

**VÃ­ dá»¥ Ä‘Æ¡n giáº£n:**
- Giá»‘ng nhÆ° **bÃ¡c sÄ©** khÃ¡m vÃ  Ä‘Æ°a ra lá»i khuyÃªn
- Nháº­n: Nhiá»‡t Ä‘á»™, Ä‘á»™ áº©m, Ä‘á»™ áº©m Ä‘áº¥t
- Tráº£ vá»: TÃªn cÃ¢y trá»“ng phÃ¹ há»£p + Ä‘á»™ tin cáº­y

**CÃ¡ch hoáº¡t Ä‘á»™ng:**
```
1. Model RandomForest Ä‘Ã£ Ä‘Æ°á»£c train sáºµn (file .pkl)
2. Khi khá»Ÿi Ä‘á»™ng service â†’ Load model vÃ o memory
3. Nháº­n request: {temperature: 25, humidity: 80, soil_moisture: 45}
4. Model dá»± Ä‘oÃ¡n â†’ Tráº£ vá»: "watermelon" (DÆ°a háº¥u)
5. Service chuyá»ƒn sang tiáº¿ng Viá»‡t â†’ Tráº£ vá» Backend
```

**File quan trá»ng:**
- `crop_recommendation_service.py` - API service
- `RandomForest_RecomentTree.pkl` - Model Ä‘Ã£ train

---

### 5. ğŸ› **Pest Detection ML** - `PestAndDisease/`
**Nhiá»‡m vá»¥:** Nháº­n diá»‡n sÃ¢u bá»‡nh qua áº£nh

**VÃ­ dá»¥ Ä‘Æ¡n giáº£n:**
- Giá»‘ng nhÆ° **bÃ¡c sÄ© nhÃ¬n áº£nh X-quang** vÃ  cháº©n Ä‘oÃ¡n
- Nháº­n: áº¢nh lÃ¡ cÃ¢y
- Tráº£ vá»: Loáº¡i sÃ¢u bá»‡nh + Ä‘á»™ tin cáº­y + cÃ¡ch xá»­ lÃ½

**CÃ¡ch hoáº¡t Ä‘á»™ng:**
```
1. Model Vision Transformer (ViT) Ä‘Ã£ Ä‘Æ°á»£c train sáºµn
2. User upload áº£nh lÃ¡ cÃ¢y
3. Model phÃ¢n tÃ­ch áº£nh â†’ Nháº­n diá»‡n: "Aphid" (Rá»‡p)
4. Tráº£ vá»: {disease: "Aphid", confidence: 0.92, treatment: "..."}
```

---

### 6. ğŸ’¾ **Database (PostgreSQL)**
**Nhiá»‡m vá»¥:** LÆ°u trá»¯ táº¥t cáº£ dá»¯ liá»‡u

**VÃ­ dá»¥ Ä‘Æ¡n giáº£n:**
- Giá»‘ng nhÆ° **tá»§ há»“ sÆ¡** lÆ°u trá»¯ thÃ´ng tin
- LÆ°u: User, Farm, Field, Sensor data, Harvest...

**CÃ¡c báº£ng chÃ­nh:**
- `account` - ThÃ´ng tin ngÆ°á»i dÃ¹ng
- `Farm` - NÃ´ng tráº¡i
- `Field` - Äá»“ng ruá»™ng
- `Sensor` - Cáº£m biáº¿n
- `Sensor_Data` - Dá»¯ liá»‡u tá»« cáº£m biáº¿n
- `Plant` - CÃ¢y trá»“ng
- `Harvest` - Thu hoáº¡ch

---

## ğŸ”„ LUá»’NG HOáº T Äá»˜NG Tá»”NG QUAN

### **Luá»“ng 1: ÄÄƒng nháº­p**
```
1. User má»Ÿ trÃ¬nh duyá»‡t â†’ http://localhost:80
2. Frontend hiá»ƒn thá»‹ trang Login
3. User nháº­p email/password â†’ Click "ÄÄƒng nháº­p"
4. Frontend gá»­i POST /api/auth/login Ä‘áº¿n Backend
5. Backend kiá»ƒm tra Database â†’ Táº¡o JWT token
6. Backend tráº£ vá» token â†’ Frontend lÆ°u vÃ o localStorage
7. Frontend chuyá»ƒn Ä‘áº¿n Dashboard
```

### **Luá»“ng 2: Gá»£i Ã½ cÃ¢y trá»“ng**
```
1. User vÃ o trang "Gá»£i Ã½ cÃ¢y trá»“ng"
2. Nháº­p: Nhiá»‡t Ä‘á»™ = 25Â°C, Äá»™ áº©m = 80%, Äá»™ áº©m Ä‘áº¥t = 45%
3. Click "Gá»£i Ã½ cÃ¢y trá»“ng"
4. Frontend gá»­i POST /api/crop/recommend Ä‘áº¿n Backend
5. Backend gá»i Python ML service (http://crop-service:5000/api/recommend-crop)
6. Python ML xá»­ lÃ½ â†’ Tráº£ vá»: "watermelon" (DÆ°a háº¥u)
7. Backend chuyá»ƒn Ä‘á»•i â†’ Tráº£ vá» Frontend
8. Frontend hiá»ƒn thá»‹: "CÃ¢y trá»“ng Ä‘Æ°á»£c gá»£i Ã½: DÆ°a háº¥u"
```

### **Luá»“ng 3: Há»i Chatbot**
```
1. User má»Ÿ Chatbot widget
2. GÃµ: "CÃ¡ch trá»“ng lÃºa?"
3. Frontend gá»­i Ä‘áº¿n Chatbot (http://localhost:9002)
4. Chatbot Ä‘á»c file Excel (sample-data.xlsx)
5. Gá»­i cÃ¢u há»i + dá»¯ liá»‡u Excel cho Google Gemini AI
6. AI phÃ¢n tÃ­ch vÃ  tráº£ lá»i
7. Chatbot tráº£ vá» Frontend â†’ Hiá»ƒn thá»‹ cÃ¢u tráº£ lá»i
```

### **Luá»“ng 4: PhÃ¡t hiá»‡n sÃ¢u bá»‡nh**
```
1. User vÃ o trang "PhÃ¡t hiá»‡n sÃ¢u bá»‡nh"
2. Upload áº£nh lÃ¡ cÃ¢y
3. Frontend gá»­i áº£nh Ä‘áº¿n Backend
4. Backend gá»i Python ML service (http://pest-service:5001/api/detect)
5. Python ML phÃ¢n tÃ­ch áº£nh â†’ Nháº­n diá»‡n: "Aphid"
6. Tráº£ vá»: {disease: "Aphid", confidence: 0.92, treatment: "..."}
7. Frontend hiá»ƒn thá»‹ káº¿t quáº£ + cÃ¡ch xá»­ lÃ½
```

---

## ğŸ” Báº¢O Máº¬T VÃ€ XÃC THá»°C

### **JWT Token (JSON Web Token)**
- Khi Ä‘Äƒng nháº­p thÃ nh cÃ´ng, Backend táº¡o má»™t **token** (giá»‘ng nhÆ° tháº» ID)
- Token chá»©a: Email, Role (ADMIN/FARMER...)
- Má»—i request tá»« Frontend pháº£i gá»­i kÃ¨m token
- Backend kiá»ƒm tra token â†’ Cho phÃ©p hoáº·c tá»« chá»‘i

**VÃ­ dá»¥:**
```
Login thÃ nh cÃ´ng â†’ Token: "eyJhbGciOiJIUzI1NiJ9..."
Frontend lÆ°u token vÃ o localStorage
Má»—i request gá»­i kÃ¨m: Authorization: Bearer eyJhbGciOiJIUzI1NiJ9...
```

---

## ğŸ“ Cáº¤U TRÃšC THÆ¯ Má»¤C (ÄÆ¡n giáº£n)

```
SmartFarm/
â”œâ”€â”€ J2EE_Frontend/          â† Giao diá»‡n web (React)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ App.js          â† File chÃ­nh, quáº£n lÃ½ routing
â”‚   â”‚   â”œâ”€â”€ pages/          â† CÃ¡c trang (Dashboard, Farm, Crop...)
â”‚   â”‚   â””â”€â”€ services/       â† Gá»­i request Ä‘áº¿n Backend
â”‚
â”œâ”€â”€ demoSmartFarm/demo/      â† Backend (Java Spring Boot)
â”‚   â””â”€â”€ src/main/java/
â”‚       â”œâ”€â”€ Controllers/    â† Nháº­n request tá»« Frontend
â”‚       â”œâ”€â”€ Services/      â† Xá»­ lÃ½ logic
â”‚       â”œâ”€â”€ Repositories/  â† Truy váº¥n Database
â”‚       â””â”€â”€ Entities/      â† Äá»‹nh nghÄ©a báº£ng Database
â”‚
â”œâ”€â”€ AI_SmartFarm_CHatbot/   â† Chatbot AI (Next.js)
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ app/page.tsx    â† Giao diá»‡n chatbot
â”‚       â””â”€â”€ ai/flows/       â† Logic xá»­ lÃ½ AI
â”‚
â”œâ”€â”€ RecommentCrop/          â† ML gá»£i Ã½ cÃ¢y trá»“ng (Python)
â”‚   â”œâ”€â”€ crop_recommendation_service.py  â† API service
â”‚   â””â”€â”€ RandomForest_RecomentTree.pkl   â† Model Ä‘Ã£ train
â”‚
â””â”€â”€ PestAndDisease/         â† ML phÃ¡t hiá»‡n sÃ¢u bá»‡nh (Python)
    â””â”€â”€ pest_disease_service.py  â† API service
```

---

## ğŸš€ CÃCH CHáº Y Há»† THá»NG

### **CÃ¡ch 1: DÃ¹ng Docker (KhuyÃªn dÃ¹ng)**
```bash
docker compose up -d
```
â†’ Tá»± Ä‘á»™ng cháº¡y táº¥t cáº£ services

### **CÃ¡ch 2: Cháº¡y tá»«ng service**
```bash
# 1. Database
docker compose up -d postgres

# 2. Backend
cd demoSmartFarm/demo
mvn spring-boot:run

# 3. Frontend
cd J2EE_Frontend
npm start

# 4. Chatbot
cd AI_SmartFarm_CHatbot
npm run dev

# 5. Crop ML
cd RecommentCrop
python crop_recommendation_service.py

# 6. Pest ML
cd PestAndDisease
python pest_disease_service.py
```

---

## â“ CÃ‚U Há»I THÆ¯á»œNG Gáº¶P

### **Q: Frontend vÃ  Backend khÃ¡c nhau nhÆ° tháº¿ nÃ o?**
**A:** 
- **Frontend** = Giao diá»‡n ngÆ°á»i dÃ¹ng tháº¥y (nhÆ° mÃ n hÃ¬nh TV)
- **Backend** = Xá»­ lÃ½ logic phÃ­a sau (nhÆ° bá»™ nÃ£o)

### **Q: Táº¡i sao cáº§n nhiá»u services?**
**A:** 
- Má»—i service lÃ m má»™t viá»‡c riÃªng (chia nhá» Ä‘á»ƒ dá»… quáº£n lÃ½)
- Frontend = Giao diá»‡n
- Backend = Logic chÃ­nh
- Chatbot = AI riÃªng
- Crop ML = Machine Learning riÃªng
- Pest ML = Machine Learning riÃªng

### **Q: Database lÆ°u gÃ¬?**
**A:** 
- Táº¥t cáº£ dá»¯ liá»‡u: User, Farm, Field, Sensor data, Harvest...
- Giá»‘ng nhÆ° file Excel nhÆ°ng cÃ³ cáº¥u trÃºc vÃ  cÃ³ thá»ƒ truy váº¥n nhanh

### **Q: JWT Token lÃ  gÃ¬?**
**A:** 
- Giá»‘ng nhÆ° **tháº» ID** chá»©ng minh báº¡n Ä‘Ã£ Ä‘Äƒng nháº­p
- Má»—i request pháº£i gá»­i kÃ¨m token
- Backend kiá»ƒm tra token â†’ Cho phÃ©p hoáº·c tá»« chá»‘i

---

## ğŸ“ TÃ“M Táº®T

**Há»‡ thá»‘ng Smart Farm gá»“m:**
1. **Frontend** - Giao diá»‡n web (React)
2. **Backend** - Xá»­ lÃ½ logic (Java Spring Boot)
3. **Chatbot** - AI tÆ° váº¥n (Next.js + Google Gemini)
4. **Crop ML** - Gá»£i Ã½ cÃ¢y trá»“ng (Python + RandomForest)
5. **Pest ML** - PhÃ¡t hiá»‡n sÃ¢u bá»‡nh (Python + ViT)
6. **Database** - LÆ°u trá»¯ dá»¯ liá»‡u (PostgreSQL)

**Luá»“ng hoáº¡t Ä‘á»™ng:**
```
User â†’ Frontend â†’ Backend â†’ Database/ML Services â†’ Tráº£ vá» User
```

---

**ğŸ‰ Báº¡n Ä‘Ã£ hiá»ƒu cÆ¡ báº£n vá» há»‡ thá»‘ng! Äá»c tiáº¿p file `GIAI_THICH_HE_THONG_CHI_TIET.md` Ä‘á»ƒ biáº¿t chi tiáº¿t ká»¹ thuáº­t!**

