spring.application.name=demo

# Database configuration - Production
spring.datasource.url=jdbc:postgresql://${DB_HOST:postgres}:${DB_PORT:5432}/${DB_NAME:SmartFarm1}
spring.datasource.username=${DB_USER:postgres}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# Connection pool settings
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# JPA settings
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# Jackson configuration for LocalDateTime serialization
# Serialize LocalDateTime as ISO 8601 with UTC timezone (Z suffix)
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.time-zone=UTC

# Disable auto-configuration (KHÔNG exclude Security - cần Security để authentication hoạt động)
# spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration

# Server settings
server.port=8080
server.compression.enabled=true
server.compression.mime-types=application/json,application/xml,text/html,text/xml,text/plain

# Logging
logging.level.root=INFO
logging.level.com.example.demo=INFO
logging.level.org.springframework.web=WARN
logging.level.org.hibernate=WARN
logging.file.name=/app/logs/application.log
logging.file.max-size=10MB
logging.file.max-history=30

# JWT Configuration
jwt.secret=${JWT_SECRET}
jwt.expiration=${JWT_EXPIRATION:86400000}

# External Services URLs
crop.recommendation.url=${CROP_RECOMMENDATION_URL:http://crop-service:5000}
pest.disease.service.url=${PEST_DISEASE_URL:http://pest-service:5001}

# CORS Configuration
cors.allowed-origins=${FRONTEND_ORIGINS:http://localhost:3000,http://localhost:80}

# Actuator (for health checks and monitoring)
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=when-authorized
management.health.db.enabled=true

# Email Configuration - Sử dụng environment variables từ docker-compose
# ⚠️ ĐÃ TẮT - Để bật lại, uncomment các dòng bên dưới và set MAIL_HOST trong docker-compose.yml
# Nếu không set, email service sẽ không hoạt động (không gây lỗi)
#spring.mail.host=${MAIL_HOST:}
#spring.mail.port=${MAIL_PORT:587}
#spring.mail.username=${MAIL_USERNAME:}
#spring.mail.password=${MAIL_PASSWORD:}
#spring.mail.properties.mail.smtp.auth=true
#spring.mail.properties.mail.smtp.starttls.enable=true
#spring.mail.properties.mail.smtp.starttls.required=true
#spring.mail.default-encoding=UTF-8
#app.mail.from=${MAIL_FROM:alerts@smartfarm.com}

# Connection timeout
#spring.mail.properties.mail.smtp.connectiontimeout=5000
#spring.mail.properties.mail.smtp.timeout=5000
#spring.mail.properties.mail.smtp.writetimeout=5000

